# ğŸ“Œ Singleton íŒ¨í„´

## ê°œìš”

í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì— **ì˜¤ì§ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤**ë§Œì„ ìƒì„±í•˜ëŠ” íŒ¨í„´ìœ¼ë¡œ,  
ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ì— **ë§ì€ ë¹„ìš©**ì´ ë“œëŠ” ê²½ìš°, íŠ¹íˆ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ëª¨ë“ˆ (ì˜ˆ: MySQL)ì— ìì£¼ ì‚¬ìš©ëœë‹¤.

## ì¥ì 

- **ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë¹„ìš© ì ˆê°**: í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ì—¬ ìì›ì˜ ë‚­ë¹„ë¥¼ ì¤„ì„.
- **íš¨ìœ¨ì ì¸ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬**: ë°ì´í„°ë² ì´ìŠ¤ì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ.

## ë‹¨ì 
- **ì˜ì¡´ì„± ì¦ê°€** <br>
Singleton ê°ì²´ì— ì˜ì¡´í•˜ëŠ” ì½”ë“œê°€ ë§ì•„ì§. <br>
- **TDD (Test-Driven Development) ë¶ˆí¸** <br>
ingleton ê°ì²´ëŠ” í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ìš´ ê²½ìš°ê°€ ë§ê³ , <br>
ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ë¿ì´ë¼ í…ŒìŠ¤íŠ¸ ì‹œ ë…ë¦½ì ì¸ ê°ì²´ ìƒì„±ì´ ì–´ë ¤ì›€. <br>

## ì‚¬ìš© ì˜ˆì‹œ
ë³¸ë˜ ì‹±ê¸€í†¤ì´ ì•„ë‹Œ í´ë˜ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
```JavaScript

class User {
  constructor(name) {
    this.name = name;
  }

  greet() {
    return `Hello, my name is ${this.name}`;
  }
}

const user1 = new User('Alice');
const user2 = new User('Bob');

console.log(user1 === user2); // false ì´ë‹¤.
console.log(user1.greet()); // Hello, my name is Alice ì´ë‹¤.
console.log(user2.greet()); // Hello, my name is Bob ì´ë‹¤.
```
ìœ„ì˜ User í´ë˜ìŠ¤ëŠ” ì¼ë°˜ì ì¸ í´ë˜ìŠ¤ì´ë‹¤. <br>
new í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. <br>
user1ê³¼ user2ëŠ” ì„œë¡œ ë‹¤ë¥¸ ê°ì²´ì´ë¯€ë¡œ === ë¹„êµ ê²°ê³¼ëŠ” falseì´ë‹¤.<br>


# ì‹±ê¸€í†¤ íŒ¨í„´ - JavaScript
```JavaScript

class Configuration {
  constructor(settings) {
    if (!Configuration.instance) {
      this.settings = settings;
      Configuration.instance = this;
    }
    return Configuration.instance;
  }

  getSetting(key) {
    return this.settings[key];
  }
}

const config1 = new Configuration({ theme: 'dark', language: 'en' });
const config2 = new Configuration({ theme: 'light' }); // ì´ ì„¤ì •ì€ ë¬´ì‹œëœë‹¤.

console.log(config1 === config2); // true ì´ë‹¤.
console.log(config1.getSetting('theme')); // dark ì´ë‹¤.
console.log(config2.getSetting('language')); // en ì´ë‹¤.
```
Configuration í´ë˜ìŠ¤ëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ì„ êµ¬í˜„í•œ ê²ƒì´ë‹¤. <br>
ìƒì„±ì ë‚´ì—ì„œ Configuration.instanceê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œë§Œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³ , <br>
ì´í›„ì—ëŠ” ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤. ë”°ë¼ì„œ config1ê³¼ config2ëŠ” ë™ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•˜ë©°, <br>
ì²˜ìŒ ì„¤ì •ëœ settings ê°ì²´ë¥¼ ê³µìœ í•œë‹¤.


# DB ì—°ê²° ëª¨ë“ˆ
```JavaScript

class DatabaseConnection {
  constructor(dbName) {
    if (!DatabaseConnection.instance) {
      this.dbName = dbName;
      this.connection = this.connect();
      DatabaseConnection.instance = this;
    }
    return DatabaseConnection.instance;
  }

  connect() {
    console.log(`Connecting to database: ${this.dbName}`);
    // ì‹¤ì œ DB ì—°ê²° ë¡œì§ (ê°€ì •)
    return { state: 'connected', db: this.dbName };
  }

  getConnection() {
    return this.connection;
  }
}

const dbConn1 = new DatabaseConnection('user_data');
const dbConn2 = new DatabaseConnection('order_data'); // ì´ ì—°ê²° ì‹œë„ëŠ” ê¸°ì¡´ ì—°ê²°ì„ ë°˜í™˜í•œë‹¤.

console.log(dbConn1 === dbConn2); // true ì´ë‹¤.
const conn1Info = dbConn1.getConnection();
const conn2Info = dbConn2.getConnection();
console.log(conn1Info); // { state: 'connected', db: 'user_data' } ì´ë‹¤.
console.log(conn2Info); // { state: 'connected', db: 'user_data' } ì´ë‹¤.
```
DatabaseConnection í´ë˜ìŠ¤ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ ê´€ë¦¬í•˜ëŠ” ì‹±ê¸€í†¤ ëª¨ë“ˆì´ë‹¤. <br>
ì²˜ìŒ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë  ë•Œ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ê³ , ì´í›„ì—ëŠ” <br>
í•­ìƒ ë™ì¼í•œ ì—°ê²° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•˜ì—¬ ë¶ˆí•„ìš”í•œ ì—°ê²° ìƒì„±ì„ ë°©ì§€í•œë‹¤.<br>


# MongoDB ì—°ê²° ëª¨ë“ˆ
```JavaScript

// ê°„ë‹¨í•œ MongoDB ì—°ê²° ê´€ë¦¬ ì‹±ê¸€í†¤ ì˜ˆì‹œ (ì‹¤ì œ MongoDB ì—°ê²°ì€ ë¹„ë™ê¸°ì ì¼ ìˆ˜ ìˆë‹¤.)
class MongoDBConnection {
  constructor(uri) {
    if (!MongoDBConnection.instance) {
      this.uri = uri;
      this.client = this.connect();
      MongoDBConnection.instance = this;
    }
    return MongoDBConnection.instance;
  }

  connect() {
    console.log(`Connecting to MongoDB: ${this.uri}`);
    // ì‹¤ì œ MongoDB ì—°ê²° ë¡œì§ (ê°€ì •)
    return { status: 'connected', uri: this.uri };
  }

  getClient() {
    return this.client;
  }
}

const mongoConn1 = new MongoDBConnection('mongodb://localhost:27017/mydb');
const mongoConn2 = new MongoDBConnection('mongodb://anotherhost:27017/otherdb'); // ë¬´ì‹œëœë‹¤.

console.log(mongoConn1 === mongoConn2); // true ì´ë‹¤.
console.log(mongoConn1.getClient()); // { status: 'connected', uri: 'mongodb://localhost:27017/mydb' } ì´ë‹¤.
console.log(mongoConn2.getClient()); // { status: 'connected', uri: 'mongodb://localhost:27017/mydb' } ì´ë‹¤.
```
MongoDBConnection í´ë˜ìŠ¤ëŠ” MongoDB ì—°ê²°ì„ ê´€ë¦¬í•˜ëŠ” ì‹±ê¸€í†¤ì´ë‹¤. <br>
ìµœì´ˆ ì—°ê²° ì‹œë„ì— ì„±ê³µí•˜ë©´ í•´ë‹¹ ì—°ê²° ê°ì²´ë¥¼ ìœ ì§€í•˜ê³ , <br>
ì´í›„ì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œë„ì—ëŠ” ê¸°ì¡´ ì—°ê²° ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. <br>


# ì‹±ê¸€í†¤ íŒ¨í„´ - Java 
```Java

public class Logger {
    private static Logger instance;

    private Logger() {
        // private ìƒì„±ìë¡œ ì™¸ë¶€ì—ì„œì˜ ì§ì ‘ì ì¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ì„ ë°©ì§€í•œë‹¤.
    }

    public static Logger getInstance() {
        if (instance == null) {
            synchronized (Logger.class) {
                if (instance == null) {
                    instance = new Logger();
                }
            }
        }
        return instance;
    }

    public void log(String message) {
        System.out.println("[LOG] " + message);
    }

    public static void main(String[] args) {
        Logger logger1 = Logger.getInstance();
        Logger logger2 = Logger.getInstance();

        System.out.println(logger1 == logger2); // true ì´ë‹¤.

        logger1.log("Application started.");
        logger2.log("User logged in.");
    }
}
```
Javaì—ì„œ ì‹±ê¸€í†¤ íŒ¨í„´ì€ ì£¼ë¡œ getInstance() ë©”ì„œë“œë¥¼ í†µí•´ êµ¬í˜„ëœë‹¤. <br>
instance ë³€ìˆ˜ëŠ” staticìœ¼ë¡œ ì„ ì–¸ë˜ì–´ í´ë˜ìŠ¤ ë¡œë”© ì‹œì ì— í•œ ë²ˆë§Œ ì´ˆê¸°í™”ëœë‹¤. <br>
private ìƒì„±ìëŠ” ì™¸ë¶€ì—ì„œì˜ ì§ì ‘ì ì¸ ì¸ìŠ¤í„´ìŠ¤í™”ë¥¼ ë§‰ëŠ”ë‹¤. <br>
synchronized í‚¤ì›Œë“œëŠ” ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê²Œ ë‹¨ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë§Œ ìƒì„±ë˜ë„ë¡ ë³´ì¥í•œë‹¤.

# ì‹±ê¸€í†¤ì˜ ë‹¨ì 
ë‹¨ì ì„ ë³´ì—¬ì£¼ëŠ” ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤. <br>
```javascript
const assert = require('assert');

// ì‹±ê¸€í†¤ìœ¼ë¡œ ê´€ë¦¬ë˜ëŠ” ì„¤ì • ê°ì²´ (ê°€ì •)
class SingletonConfig {
  constructor() {
    if (!SingletonConfig.instance) {
      this.data = { setting1: 'initial', setting2: 'default' };
      SingletonConfig.instance = this;
    }
    return SingletonConfig.instance;
  }

  get(key) {
    return this.data[key];
  }

  set(key, value) {
    this.data[key] = value;
  }

  reset() {
    this.data = { setting1: 'initial', setting2: 'default' };
  }
}

describe('SingletonConfig', function () {
  let config1;
  let config2;

  beforeEach(function () {
    config1 = new SingletonConfig();
    config2 = new SingletonConfig();
  });

  afterEach(function () {
    // ê° í…ŒìŠ¤íŠ¸ ì´í›„ ì‹±ê¸€í†¤ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ì—¬ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šë„ë¡ í•œë‹¤.
    config1.reset();
  });

  it('should have the same instance for multiple instantiations', function () {
    assert.strictEqual(config1, config2); // ë‘ ë³€ìˆ˜ëŠ” ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•´ì•¼ í•œë‹¤.
  });

  describe('Test 1: Modifying Singleton State', function () {
    it('should allow modification of the shared state', function () {
      config1.set('setting1', 'modified_by_test1');
      assert.strictEqual(config2.get('setting1'), 'modified_by_test1'); // ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì—ì„œë„ ë³€ê²½ëœ ìƒíƒœê°€ ë°˜ì˜ëœë‹¤.
    });
  });

  describe('Test 2: Demonstrating Inter-Test Dependency', function () {
    it('should be affected by the previous test if state is not reset', function () {
      // Test 1ì—ì„œ 'setting1'ì´ 'modified_by_test1'ë¡œ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ, reset()ì´ ì—†ë‹¤ë©´ ì´ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì¤€ë‹¤.
      assert.notStrictEqual(config1.get('setting1'), 'initial');
    });

    it('should have the initial state after reset', function () {
      assert.strictEqual(config1.get('setting1'), 'initial'); // reset() ë•ë¶„ì— ì´ˆê¸° ìƒíƒœì´ë‹¤.
    });
  });
});
```
`SingletonConfig í´ë˜ìŠ¤` <br>
ì‹±ê¸€í†¤ íŒ¨í„´ì„ êµ¬í˜„í•œ ì„¤ì • ê´€ë¦¬ í´ë˜ìŠ¤ë¥¼ ê°€ì •í•œ ê²ƒì´ë‹¤. <br>
ì´ëŠ” ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ì‹±ê¸€í†¤ì˜ ì¼ë°˜ì ì¸ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ë‹¤.<br>


`beforeEach`ì™€ `afterEach` <br>
Mochaì˜ í›…ì„ ì‚¬ìš©í•˜ì—¬ ê° í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „í›„ì— ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ëŠ” ê²ƒì´ë‹¤. <br>
 ì´ëŠ” ì‹±ê¸€í†¤ì˜ ìƒíƒœê°€ í…ŒìŠ¤íŠ¸ ê°„ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì ì¬ì ì¸ ë¬¸ì œë¥¼ ê°•ì¡°í•˜ê¸° ìœ„í•¨ì´ë‹¤. <br><br>
**`ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸ (should have the same instance...)`** <br>
ì‹±ê¸€í†¤ì˜ í•µì‹¬ íŠ¹ì§•ì¸ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ì„ì„ í™•ì¸í•˜ëŠ” ê²ƒì´ë‹¤. <br> <br>
**`ë‘ ë²ˆì§¸ í…ŒìŠ¤íŠ¸ ê·¸ë£¹ (Test 1: Modifying Singleton State)`** <br> 
í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ì—ì„œ ì‹±ê¸€í†¤ ê°ì²´ì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ì°¸ì¡°ì—ì„œë„ ë³€ê²½ëœ ìƒíƒœê°€ ë°˜ì˜ë¨ì„ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ë‹¤. <br>
ì´ëŠ” ì‹±ê¸€í†¤ì´ ì „ì—­ ìƒíƒœë¥¼ ê°€ì§€ê²Œ ë˜ì–´ ì˜ˆìƒì¹˜ ëª»í•œ side effectë¥¼ ìœ ë°œí•  ìˆ˜ ìˆë‹¤ëŠ” ë‹¨ì ì„ ê°„ì ‘ì ìœ¼ë¡œ ë“œëŸ¬ë‚´ëŠ” ê²ƒì´ë‹¤. <br><br>
**`ì„¸ ë²ˆì§¸ í…ŒìŠ¤íŠ¸ ê·¸ë£¹ (Test 2: Demonstrating Inter-Test Dependency)`** <br>
**`ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸ (should be affected by the previous test...)`** <br>
afterEachì—ì„œ reset()ì„ í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì´ì „ í…ŒìŠ¤íŠ¸ì˜ ìƒíƒœ ë³€ê²½ì— ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆìŒì„ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ë‹¤. <br>
ì´ëŠ” ì‹±ê¸€í†¤ì´ í…ŒìŠ¤íŠ¸ ê°„ì˜ ì˜ì¡´ì„±ì„ ì•¼ê¸°í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ë¶ˆì•ˆì •í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì‹œì‚¬í•˜ëŠ” ê²ƒì´ë‹¤. <br><br>
**`ë‘ ë²ˆì§¸ í…ŒìŠ¤íŠ¸ (should have the initial state after reset)`** <br>
reset()ì„ í†µí•´ ê° í…ŒìŠ¤íŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ë§Œë“¤ë ¤ê³  ë…¸ë ¥í•˜ì§€ë§Œ, <br>
ê·¼ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ ìì²´ê°€ í…ŒìŠ¤íŠ¸ ê²©ë¦¬ë¥¼ ì–´ë µê²Œ ë§Œë“œëŠ” ìš”ì¸ì„ì„ ê°„ì ‘ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ë‹¤. <br><br>

<br><br><br>
ì´ ì½”ë“œëŠ” ì§ì ‘ì ìœ¼ë¡œ "ì‹±ê¸€í†¤ì€ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë µë‹¤"ë¼ê³  ë‹¨ì •í•˜ê¸°ë³´ë‹¤ëŠ”, <br>
ì‹±ê¸€í†¤ìœ¼ë¡œ ê´€ë¦¬ë˜ëŠ” ì „ì—­ ìƒíƒœê°€ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ <br>
ì–´ë–»ê²Œ ì˜ˆìƒì¹˜ ì•Šì€ ë™ì‘ì´ë‚˜ ì˜ì¡´ì„±ì„ ì•¼ê¸°í•  ìˆ˜ ìˆëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ì´ë‹¤. <br>
ê° í…ŒìŠ¤íŠ¸ê°€ ë…ë¦½ì ì´ì–´ì•¼ í•˜ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ì›ì¹™ì— ìœ„ë°°ë  ìˆ˜ ìˆìŒì„ ê°„ì ‘ì ìœ¼ë¡œ ë“œëŸ¬ë‚´ëŠ” ê²ƒì´ë‹¤.<br>

