# 시스템콜
- 커널에 접근하기 위한 인터페이스

<br>

# 시스템 콜의 과정
### 1. 트랩(Trap) 발생
- 유저 프로그램이 I/O 같은 특권 동작을 요청할 때 system call 명령을 실행한다.
- CPU가 `소프트웨어 인터럽트(트랩)`를 발생시켜 커널에게 제어권을 넘긴다.
### 2. 커널 모드 전환
- CPU의 실행 모드가 유저 모드 → 커널 모드로 바뀝니다.
- 이 과정에서 커널 스택으로 전환하고, 현재 상태(레지스터, 프로그램 카운터 등)를 저장한다.
### 3. 시스템 콜 핸들러 실행
- 시스템 콜 번호를 확인하고,
- 커널 내부의 올바른 서비스 루틴(I/O 처리,파일 관리, 프로세스 관리 등)을 찾아 실행한다.
### 4. 커널 함수 실행 및 결과 반환
- 해당 커널 함수가 실행되고 결과(성공 여부, 데이터 등)를 반환한다.
### 5. 유저 모드 복귀
- 커널 모드에서의 실행이 끝나면, CPU는 저장해둔 유저 프로그램 상태를 복구하고 유저 모드로 돌아간다.

# 시스템 콜의 장점
```text
유저 프로그램은 시스템 콜을 통해 커널과 분리되어 동작한다.
즉, 유저 프로그램은 복잡한 파일 시스템 동작이나
프로세스 생성 같은 내부 구현을 직접 다룰 필요가 없다.
운영체제가 프로그램을 관리하므로 시스템의 안정성과 보안이 향상된다.

예를 들어 공격자가 만든 카메라 앱이 제한 없이 커널에 직접 접근할 수 있다면,
카메라 관련 메모리가 오염되어 의도와 무관하게 카메라가 켜져 사생활이 노출될 위험이 있다.

이를 방지하기 위해 유저 모드에서 커널 모드로 진입할 수 있는 통로를 시스템 콜이라는
하나의 제어된 인터페이스로 제한한다.

이 인터페이스를 통해 운영체제는
권한 검사, 자원 접근 통제, 오류 처리 등을 수행하여 안전한 실행 환경을 보장한다.
```

## 기타 개념
### 커널
- 하드웨어와 응용 프로그램 사이에서 자원(프로세서, 메모리, 파일, 입출력 장치 등)을 관리하고 중재하는 역할
  
### 유저 모드
- 유저의 접근 영역을 제한적으로 두며 컴퓨터 자원에 함부로 침범하지 못하는 모드

### 커널 모드
- 모든 컴퓨터 자원에 접근할 수 있는 모드

### modebit
<img width="584" height="232" alt="geofencing png1" src="https://github.com/user-attachments/assets/8585b554-bc0d-4f8b-af9e-701616aba2dc" /> <br>
[이미지 출처](https://fjvbn2003.tistory.com/306) <br>
- 시스템콜이 작동될 때,
- modebitf를 기반으로 유저 모드와 커널 모드를 구분한다.
- 1또는 0의 값을 가지는 플래그 변수이며 1은 유저모드, 0은 커널 모드를 가리킨다.





